<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Slow Flappy with Images</title>
  <style>
    body { margin:0; overflow:hidden; background:#70c5ce; }
    canvas { display:block; margin:0 auto; background:#70c5ce; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let frames = 0;

const state = { getReady:0, game:1, over:2, current:0 };
document.addEventListener("keydown", e => {
  if (e.code === "Space") {
    if (state.current === state.getReady) state.current = state.game;
    else if (state.current === state.game) bird.flap();
    else if (state.current === state.over) location.reload();
  }
});

// Load images
const birdImg = new Image();
birdImg.src = 'https://i.imgur.com/Oj0T2s2.png'; // floppy bird placeholder

const pipeNorth = new Image();
pipeNorth.src = 'https://i.imgur.com/5a6g2UN.png';
const pipeSouth = new Image();
pipeSouth.src = 'https://i.imgur.com/bhV4SuH.png';

// Bird object
const bird = {
  x:50, y:150, w:34, h:24,
  gravity:0.05, jump:1.5, speed:0,
  draw() { ctx.drawImage(birdImg, this.x - this.w/2, this.y - this.h/2); },
  update() {
    if (state.current === state.game) {
      this.speed += this.gravity;
      this.y += this.speed;
    } else {
      this.speed = 0; this.y = 150;
    }
    if (this.y + this.h/2 >= canvas.height) state.current = state.over;
  },
  flap() { this.speed = -this.jump; }
};

// Pipes
const pipes = {
  arr: [], width:52, gap:180, dx:0.5,
  draw() {
    this.arr.forEach(p => {
      ctx.drawImage(pipeNorth, p.x, p.y);
      ctx.drawImage(pipeSouth, p.x, p.y + this.gap + pipeNorth.height);
    });
  },
  update() {
    if (state.current !== state.game) return;
    if (frames % 200 === 0) {
      this.arr.push({ x: canvas.width, y: -(pipeNorth.height + (Math.random() * 100)) });
    }
    this.arr = this.arr.filter(p => p.x > -this.width);
    this.arr.forEach(p => {
      p.x -= this.dx;
      // collision
      if (
        bird.x + bird.w/2 > p.x && bird.x - bird.w/2 < p.x + this.width &&
        (bird.y - bird.h/2 < p.y + pipeNorth.height ||
         bird.y + bird.h/2 > p.y + pipeNorth.height + this.gap)
      ) state.current = state.over;
    });
  }
};

// Main loop
function loop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  pipes.update(); pipes.draw();
  bird.update(); bird.draw();

  if (state.current === state.getReady) {
    ctx.fillStyle = "#FFF";
    ctx.font = "24px Arial";
    ctx.fillText("Press SPACE to Start", 80, 300);
  }
  if (state.current === state.over) {
    ctx.fillStyle = "#FFF";
    ctx.font = "24px Arial";
    ctx.fillText("Game Over! Press SPACE", 70, 300);
  }

  frames++;
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
